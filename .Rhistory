filter(!is.na(species)) %>%
count(species, nesting_status) %>%
ggplot(aes(x = nesting_status, y = n)) +
geom_col() +
facet_wrap(~ species, nrow = 3) +
theme(axis.text.x = element_text(angle = 50, hjust = 1)) +
labs(title = "Nesting Status comparison by turtle species")
seamap %>%
filter(!is.na(species)) %>%
count(species, nesting_status) %>%
ggplot(aes(x = nesting_status, y = n)) +
geom_col() +
facet_wrap(~ species, nrow = 3) +
theme(axis.text.x = element_text(angle = 50, hjust = 1)) +
labs(title = "Nesting Status comparison by turtle species")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
seamap %>%
filter(!is.na(species)) %>%
count(species, nesting_status) %>%
ggplot(aes(x = nesting_status, y = n)) +
geom_col() +
facet_wrap(~ species, nrow = 3) +
labs(title = "Nesting Status comparison by turtle species")+
theme(axis.text.x = element_text(angle = 50, hjust = 1)) +
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
seamap %>%
filter(!is.na(species)) %>%
count(species, nesting_status) %>%
ggplot(aes(x = nesting_status, y = n)) +
geom_col() +
facet_wrap(~ species, nrow = 3) +
labs(title = "Nesting Status comparison by turtle species",
x = "Nesting status",
y = NULL)+
theme(axis.text.x = element_text(angle = 50, hjust = 1)) +
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
seamap %>%
filter(!is.na(species)) %>%
count(species, nesting_status) %>%
ggplot(aes(x = nesting_status, y = n)) +
geom_col(fill = "lightgreen") +
facet_wrap(~ species, nrow = 3) +
labs(title = "Nesting Status comparison by turtle species",
x = "Nesting status",
y = NULL)+
theme(axis.text.x = element_text(angle = 50, hjust = 1)) +
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
=======
select(latitude, longitude) %>%
summary()
longitude <- c(-179.684, 179.613)
latitude <- c(-29.481, 43.267)
sea_bbox <- make_bbox(longitude,latitude, f=0.03)
<- get_stadiamap(sea_bbox, maptype = "stamen_terrain", zoom = 5)
install.packages("ggmap")
get_stadiamap(sea_bbox, maptype = "stamen_terrain", zoom = 5)
map1 <- get_stadiamap(sea_bbox, maptype = "stamen_terrain", zoom = 5)
map1 <- get_stadiamap(sea_bbox, maptype = "stamen_terrain", zoom = 5)
library(shiny); runApp('seamap_app.R')
library(shiny); runApp('seamap_app.R')
>>>>>>> b7dfd3da6dc05e9edd93bfd918c198fd3b702b5a
knitr::opts_chunk$set(echo = TRUE)
m
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
green_turtle <- read_csv("data/Green_sea_turtle_age_growth.csv") %>% clean_names()
green_turtle <- read_csv("data/Green_sea_turtle_age_growth.csv") %>% clean_names()
library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(dplyr)
green_turtle <- read_csv("data/Green_sea_turtle_age_growth.csv") %>% clean_names()
glimpse(green_turtle)
miss_var_summary(green_turtle)
library(naniar)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(dplyr)
library(naniar)
green_turtle <- read_csv("data/Green_sea_turtle_age_growth.csv") %>% clean_names()
glimpse(green_turtle)
miss_var_summary(green_turtle)
green_turtle %>%
group_by(sex) %>%
filter(straightline_carapace_length != "NA") %>%
summarize((avg_length = mean(straightline_carapace_length)))
green_turtle %>%
group_by(sex) %>%
filter(straightline_carapace_length != "NA") %>%
summarize(avg_length = mean(straightline_carapace_length)) %>%
ggplot(aes(x = sex, y = avg_length, fill = sex)) +
geom_col(color = "black", fill = "lightskyblue3") +
theme_light()+
labs(title = "Average Straightline Carapace Length by Sex",
x = "Sex",
y = "Average Length",
fill = "Sex")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
green_turtle %>%
group_by(age) %>%
summarize(avg_growth = mean(growth_rate, na.rm = TRUE)) %>%
ggplot(aes(x = age, y = avg_growth, color = age))+
geom_point()+
labs(title = "Growth rate by year",
x = "Age of turtle",
y = "Average growth rate",
fill = "Age")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
green_turtle %>%
group_by(sex) %>%
count(age) %>%
arrange(desc(n)) %>%
ggplot(aes(x = age, y = n))+
geom_col(position = "dodge", alpha = 0.9, fill = "olivedrab3", color = "salmon4")+
geom_text(aes(label = age), vjust = -0.5, color = "black", size = 2)+
facet_wrap(~sex)+
labs(title = "Turtle stranding ages",
x = "Turtle's age",
y = "Number of stranding",
fill = "Sex")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
scale_x_discrete()
green_turtle %>%
count(year) %>%
arrange(desc(n)) %>%
ggplot(aes(x = year, y = n))+
geom_col(position = "dodge", fill = "palegreen3")+
labs(title = "Top 5 years of green turtle stranding",
x = "Years",
y = "Number of stranding")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
scale_x_discrete()
green_turtle %>%
group_by(sex) %>%
ggplot(aes(x = sex, y = straightline_carapace_length))+
geom_boxplot(fill = "lightblue3")+
labs(title = "Range of straightline carapace length",
x = "Sex",
y = "Straightline carapace length")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(dplyr)
library(naniar)
green_turtle <- read_csv("data/Green_sea_turtle_age_growth.csv") %>% clean_names()
glimpse(green_turtle)
miss_var_summary(green_turtle)
green_turtle %>%
group_by(sex) %>%
filter(straightline_carapace_length != "NA") %>%
summarize((avg_length = mean(straightline_carapace_length)))
green_turtle %>%
group_by(sex) %>%
filter(straightline_carapace_length != "NA") %>%
summarize(avg_length = mean(straightline_carapace_length)) %>%
ggplot(aes(x = sex, y = avg_length, fill = sex)) +
geom_col(color = "black", fill = "lightskyblue3") +
theme_light()+
labs(title = "Average Straightline Carapace Length by Sex",
x = "Sex",
y = "Average Length",
fill = "Sex")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
green_turtle %>%
group_by(age) %>%
summarize(avg_growth = mean(growth_rate, na.rm = TRUE)) %>%
ggplot(aes(x = age, y = avg_growth, color = age))+
geom_point()+
labs(title = "Growth rate by year",
x = "Age of turtle",
y = "Average growth rate",
fill = "Age")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
green_turtle %>%
group_by(sex) %>%
count(age) %>%
arrange(desc(n)) %>%
ggplot(aes(x = age, y = n))+
geom_col(position = "dodge", alpha = 0.9, fill = "olivedrab3", color = "salmon4")+
geom_text(aes(label = age), vjust = -0.5, color = "black", size = 2)+
facet_wrap(~sex)+
labs(title = "Turtle stranding ages",
x = "Turtle's age",
y = "Number of stranding",
fill = "Sex")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
scale_x_discrete()
green_turtle %>%
count(year) %>%
arrange(desc(n)) %>%
ggplot(aes(x = year, y = n))+
geom_col(position = "dodge", fill = "palegreen3")+
labs(title = "Top 5 years of green turtle stranding",
x = "Years",
y = "Number of stranding")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
scale_x_discrete()
green_turtle %>%
group_by(sex) %>%
ggplot(aes(x = sex, y = straightline_carapace_length))+
geom_boxplot(fill = "lightblue3")+
labs(title = "Range of straightline carapace length",
x = "Sex",
y = "Straightline carapace length")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
green_turtle %>%
group_by(age) %>%
summarize(avg_growth = mean(growth_rate, na.rm = TRUE)) %>%
ggplot(aes(x = age, y = avg_growth, color = age))+
geom_point()+
labs(title = "Growth rate by year",
x = "Age of turtle",
y = "Average growth rate",
fill = "Age")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
green_turtle %>%
summary(straightline_carapace_length)
summary(straightline_carapace_length)
green_turtle %>%
group_by(sex) %>%
summary(straightline_carapace_length)
green_turtle %>%
group_by(sex) %>%
ggplot(aes(x = sex, y = straightline_carapace_length))+
geom_boxplot(fill = "lightblue3")+
geom_text(aes(label = age), vjust = -0.5, color = "black", size = 2)+
labs(title = "Range of straightline carapace length",
x = "Sex",
y = "Straightline carapace length")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
green_turtle %>%
group_by(sex) %>%
ggplot(aes(x = sex, y = straightline_carapace_length))+
geom_boxplot(fill = "lightblue3")+
labs(title = "Range of straightline carapace length",
x = "Sex",
y = "Straightline carapace length")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
View(green_turtle)
green_turtle %>%
filter(sex == "Female")
green_turtle %>%
filter(sex == "Female") %>%
summary(straightline_carapace_length)
green_turtle %>%
filter(sex == "Male") %>%
summary(straightline_carapace_length)
green_turtle %>%
filter(sex == "Female") %>%
summary(straightline_carapace_length)
View(green_turtle)
knitr::opts_chunk$set(echo = TRUE)
green_turtle %>%
group_by(age) %>%
summarize(avg_growth = mean(growth_rate, na.rm = TRUE)) %>%
ggplot(aes(x = age, y = avg_growth, color = age))+
geom_point()+
labs(title = "Growth rate by age",
x = "Age of turtle",
y = "Average growth rate",
fill = "Age")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(dplyr)
library(naniar)
green_turtle <- read_csv("data/Green_sea_turtle_age_growth.csv") %>% clean_names()
glimpse(green_turtle)
miss_var_summary(green_turtle)
green_turtle %>%
group_by(sex) %>%
filter(straightline_carapace_length != "NA") %>%
summarize((avg_length = mean(straightline_carapace_length)))
green_turtle %>%
group_by(sex) %>%
filter(straightline_carapace_length != "NA") %>%
summarize(avg_length = mean(straightline_carapace_length)) %>%
ggplot(aes(x = sex, y = avg_length, fill = sex)) +
geom_col(color = "black", fill = "lightskyblue3") +
theme_light()+
labs(title = "Average Straightline Carapace Length by Sex",
x = "Sex",
y = "Average Length",
fill = "Sex")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
green_turtle %>%
group_by(age) %>%
summarize(avg_growth = mean(growth_rate, na.rm = TRUE)) %>%
ggplot(aes(x = age, y = avg_growth, color = age))+
geom_point()+
labs(title = "Growth rate by age",
x = "Age of turtle",
y = "Average growth rate",
fill = "Age")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
green_turtle %>%
group_by(sex) %>%
count(age) %>%
arrange(desc(n)) %>%
ggplot(aes(x = age, y = n))+
geom_col(position = "dodge", alpha = 0.9, fill = "olivedrab3", color = "salmon4")+
geom_text(aes(label = age), vjust = -0.5, color = "black", size = 2)+
facet_wrap(~sex)+
labs(title = "Turtle stranding ages",
x = "Turtle's age",
y = "Number of stranding",
fill = "Sex")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
scale_x_discrete()
green_turtle %>%
count(year) %>%
arrange(desc(n)) %>%
ggplot(aes(x = year, y = n))+
geom_col(position = "dodge", fill = "palegreen3")+
labs(title = "Top 5 years of green turtle stranding",
x = "Years",
y = "Number of stranding")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))+
scale_x_discrete()
green_turtle %>%
group_by(sex) %>%
ggplot(aes(x = sex, y = straightline_carapace_length))+
geom_boxplot(fill = "lightblue3")+
labs(title = "Range of straightline carapace length",
x = "Sex",
y = "Straightline carapace length")+
theme(plot.title=element_text(size=rel(1.75), hjust = 0.5))
green_turtle %>%
filter(sex == "Male") %>%
summary(straightline_carapace_length)
green_turtle %>%
filter(sex == "Female") %>%
summary(straightline_carapace_length)
View(seamap)
green_turtle %>%
count(year) %>%
arrange(desc(n))
knitr::opts_chunk$set(echo = TRUE)
florida_stranding %>%
filter(commonname=="Green turtle" | commonname=="Loggerhead") %>%
ggplot(aes(x=month))+
geom_bar(fill="#C3B1E1", alpha=0.9)+
facet_wrap(~commonname)+
theme(axis.text.x = element_text(hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number of Sea Turtle Strandings by Species in Each Month in Florida",
y="Number of Strandings",
x="Month")+
scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"))
knitr::opts_chunk$set(echo = TRUE)
library("tidyverse")
library("janitor")
library("naniar")
library(ggplot2)
library(ggmap)
library(RColorBrewer)
florida_stranding <- read_csv("data/Sea_Turtle_Strandings_Florida.csv") %>% clean_names()
summary(florida_stranding)
glimpse(florida_stranding)
florida_stranding %>%
naniar::miss_var_summary()
florida_stranding <- florida_stranding %>%
rename(longitude = x, latitude = y)
register_stadiamaps("cf7e4fa6-eb1a-4afb-a4a8-6d5d47e2a05a", write = FALSE) #API Key
florida_stranding %>%
#y=latitude, x=longitude
select(longitude, latitude) %>%
summary()
lat_florida <- c(24.23, 30.72)
long_florida <- c(-87.52, -79.49)
bbox_florida <- make_bbox(long_florida, lat_florida, f = 0.03) #f is the fraction of the bounding box to add to the range
map_florida <- get_stadiamap(bbox_florida, maptype = "stamen_terrain", zoom=7)
green_palette <- RColorBrewer::brewer.pal(7, "PRGn")
ggmap(map_florida) +
geom_point(data = florida_stranding, aes(longitude, latitude, color = commonname),
size = 0.5) +
scale_color_manual(values = setNames(green_palette, levels(florida_stranding$commonname))) +
labs(x = "Longitude", y = "Latitude", title = "Sea Turtle Stranding Locations in Florida by Species")
florida_stranding %>%
group_by(commonname) %>%
count(commonname) %>%
arrange(desc(n))
florida_stranding %>%
count(commonname) %>%
ggplot(aes(x = reorder(commonname, -n), y = n, fill = commonname)) +
geom_col(alpha = 0.7) +
geom_text(aes(label = n), vjust = -0.5, color = "grey43", size = 3) +
theme(axis.text.x = element_text(angle = 60, hjust = 1),
plot.title = element_text(size = rel(1), hjust = 0.5)) +
labs(title = "Total Number of Sea Turtle Strandings by Species in Florida Through the Years",
y = "Number of Strandings",
x = "Species") +
scale_fill_manual(values = rep("darkgreen", n_distinct(florida_stranding$commonname)))+
guides(fill = FALSE)
florida_stranding %>%
mutate(year = as.factor(year),
alternating_color = ifelse(as.numeric(year) %% 2 == 0, "#006E2E", "#57BB8A")) %>%
ggplot(aes(x = year, fill = alternating_color)) +
geom_bar(alpha = 0.7) +
scale_fill_manual(values = c("#006E2E", "#57BB8A")) +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
plot.title = element_text(size = rel(1), hjust = 0.5)) +
labs(title = "Number of Sea Turtle Strandings by Year in Florida (1980-2022)",
y = "Number of Strandings") +
guides(fill = FALSE)
florida_stranding %>%
ggplot(aes(x=month))+
geom_bar(fill="#C3B1E1", alpha=0.9)+
facet_wrap(~commonname)+
theme(axis.text.x = element_text(angle = 60, hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number of Sea Turtle Strandings by Species in Each Month in Florida",
y="Number of Strandings",
x="Month")+
scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"))
green_palette <- c("#D3FCC3", "#57BB8A")
florida_stranding %>%
filter(commonname %in% c("Green turtle", "Loggerhead")) %>%
filter(condition != "NULL") %>%
group_by(commonname, condition) %>%
summarise(count = n()) %>%
ggplot(aes(x = condition, y = count, fill = commonname)) +
geom_col(position = "dodge", alpha = 0.8) +
geom_text(aes(label = count), position = position_dodge(width = 0.8), vjust = -0.5, color = "grey43", size = 2.5) +
scale_fill_manual(values = setNames(green_palette, c("Green turtle", "Loggerhead"))) +
theme(axis.text.x = element_text(angle = 60, hjust = 1),
plot.title = element_text(size = rel(1), hjust = 0.5)) +
labs(title = "Strandings Condition of Green Turtle and Loggerhead in Florida",
y = "Number of Strandings",
x = "Condition",
fill = "Species")
florida_stranding %>%
filter(commonname=="Green turtle" | commonname=="Loggerhead") %>%
ggplot(aes(x=month))+
geom_bar(fill="#C3B1E1", alpha=0.9)+
facet_wrap(~commonname)+
theme(axis.text.x = element_text(hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number of Sea Turtle Strandings by Species in Each Month in Florida",
y="Number of Strandings",
x="Month")+
scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"))
florida_stranding %>%
filter(commonname=="Green turtle" | commonname=="Loggerhead") %>%
ggplot(aes(x=month))+
geom_bar(fill="#C3B1E1", alpha=0.9)+
facet_wrap(~commonname)+
theme(axis.text.x = element_text(angle=30,hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number of Sea Turtle Strandings by Species in Each Month in Florida",
y="Number of Strandings",
x="Month")+
scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"))
florida_stranding %>%
filter(commonname=="Green turtle" | commonname=="Loggerhead") %>%
ggplot(aes(x=month))+
geom_bar(fill="#C3B1E1", alpha=0.9)+
facet_wrap(~commonname)+
theme(axis.text.x = element_text(angle=20,hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number of Sea Turtle Strandings by Species in Each Month in Florida",
y="Number of Strandings",
x="Month")+
scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"))
florida_stranding %>%
filter(commonname=="Green turtle" | commonname=="Loggerhead") %>%
ggplot(aes(x=month))+
geom_bar(fill="#C3B1E1", alpha=0.9)+
facet_wrap(~commonname)+
theme(axis.text.x = element_text(angle=40,hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number of Sea Turtle Strandings by Species in Each Month in Florida",
y="Number of Strandings",
x="Month")+
scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"))
florida_stranding %>%
filter(commonname=="Green turtle" | commonname=="Loggerhead") %>%
ggplot(aes(x=month))+
geom_bar(fill="#C3B1E1", alpha=0.9)+
facet_wrap(~commonname)+
theme(axis.text.x = element_text(angle=30,hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number of Sea Turtle Strandings by Species in Each Month in Florida",
y="Number of Strandings",
x="Month")+
scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"))
florida_stranding %>%
filter(commonname=="Green turtle" | commonname=="Loggerhead") %>%
ggplot(aes(x=month))+
geom_bar(fill="#C3B1E1", alpha=0.9)+
facet_wrap(~commonname)+
theme(axis.text.x = element_text(angle=30,hjust=1),
plot.title=element_text(size=rel(1), hjust = 0.5))+
labs(title="Number of Strandings of Green Turtle and Loggerhead by Month in Florida",
y="Number of Strandings",
x="Month")+
scale_x_discrete(limits=c("1","2","3", "4", "5", "6", "7", "8", "9", "10", "11", "12"))
ggmap(map_florida) +
geom_point(data = florida_stranding, aes(longitude, latitude, color = commonname),
size = 0.5) +
scale_color_manual(values = setNames(green_palette, levels(florida_stranding$commonname))) +
labs(x = "Longitude", y = "Latitude", title = "Sea Turtle Stranding Locations in Florida by Species")
green_palette <- RColorBrewer::brewer.pal(7, "PRGn")
ggmap(map_florida) +
geom_point(data = florida_stranding, aes(longitude, latitude, color = commonname),
size = 0.5) +
scale_color_manual(values = setNames(green_palette, levels(florida_stranding$commonname))) +
labs(x = "Longitude", y = "Latitude", title = "Sea Turtle Stranding Locations in Florida by Species")
